## External API Collection
[![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/63b9bfe39b5c3b0b9a8c#?env%5BL1%5D=W3siZW5hYmxlZCI6dHJ1ZSwia2V5Ijoic2VydmVyIiwidmFsdWUiOiJzYWJhc2UuaWRldi5mZWRleC5jb206MjQ0MyIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJvcmdJZCIsInZhbHVlIjoiMjYxIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6ImpvdXJuZXlJZCIsInZhbHVlIjoiNjU4MzMiLCJ0eXBlIjoidGV4dCJ9LHsiZW5hYmxlZCI6dHJ1ZSwia2V5IjoidHJpZ2dlclRlbXBsYXRlSWQiLCJ2YWx1ZSI6IjY0NDgzIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6InJlcG9ydFR5cGUiLCJ2YWx1ZSI6ImNzdiIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJ0eXBlIiwidmFsdWUiOiJjc3YiLCJ0eXBlIjoidGV4dCJ9LHsiZW5hYmxlZCI6dHJ1ZSwia2V5IjoicmVwb3J0TmFtZSIsInZhbHVlIjoiam91cm5leVBoYXNlcyIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJzZWFyY2hWYWx1ZSIsInZhbHVlIjoiTUVNIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6Im1lbWJlcklkIiwidmFsdWUiOiI4NTgxIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6InJlcG9ydElkIiwidmFsdWUiOiIzOTgxIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6InVzZXIiLCJ2YWx1ZSI6InFhc2Vuc2Vhd2FyZWw2QGdtYWlsLmNvbSIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJjb21tZW50SWQiLCJ2YWx1ZSI6IjE4Nzc2NCIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJtZW1iZXJPcmdJZCIsInZhbHVlIjoiNzc0MSIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJ0ZW1wbGF0ZUlkIiwidmFsdWUiOiI2OTYyMSIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJkZXZpY2VJZCIsInZhbHVlIjoiODk0MiIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJwYXRoIiwidmFsdWUiOiJzYXNlYy9FQ3VzdG9tZXJTZXJ2aWNlcy9yZXN0L3YxL3Nlc3Npb24iLCJ0eXBlIjoidGV4dCJ9LHsiZW5hYmxlZCI6dHJ1ZSwia2V5IjoidGltZXN0YW1wIiwidmFsdWUiOiJuZXcgRGF0ZSgpIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6ImNsaWVudEtleSIsInZhbHVlIjoiRm5SL1FqNEllVnhsUTZyb1NHZXRLWGZzNXZrY2Y4czFVSmdCZTdJTDcvQVJGTVJ3c3psWmNSY1puc3hzU2loSmk4emx5SVFTQXNoeEVOTXh2TTN6TFE9PSIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJNSUNIQUVMU19DTElFTlRfSUQiLCJ2YWx1ZSI6Ik1JQ0hBRUxTIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6Ik1JQ0hBRUxTX1BSSVZBVEVfS0VZIiwidmFsdWUiOiJhYmNkYWJjZDEyMzQxMjM0IiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6Ik5FV0wxT1JHX1BSSVZBVEVfS0VZIiwidmFsdWUiOiIxMjM0MTIzNGFiY2RhYmNkIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6Ik5FV0wxT1JHX0NMSUVOVF9JRCIsInZhbHVlIjoiTkVXTDFPUkciLCJ0eXBlIjoidGV4dCJ9LHsiZW5hYmxlZCI6dHJ1ZSwia2V5IjoiTU5YX1BSSVZBVEVfS0VZIiwidmFsdWUiOiJhYmNkMTIzNGFiY2QxMjM0IiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6Ik1OWF9DTElFTlRfSUQiLCJ2YWx1ZSI6Ik1OWCIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJ1cmkiLCJ2YWx1ZSI6Ii9zYXNlYy9FQ3VzdG9tZXJTZXJ2aWNlcy9yZXN0L3YxL3Nlc3Npb24/Xz0xNDkyMDA4MjI4Njc2IiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6ImNsaWVudElkIiwidmFsdWUiOiJNSUNIQUVMUyIsInR5cGUiOiJ0ZXh0In1d)

### crypto-js
We are using the JavaScript library `crypto-js` to do our AES encryption. Because of the current limitations of Postman to be
able to pull in external libraries, the first test case in the collection fetches the library and sets it as a Postman
global variable.

This test case only has to be run once (or if after blowing away the global variable `module:crypto`). You will need to run
the variable contents through `eval` before any test case that needs to use it in the "Pre-request Script" tab. For example,
 
```js
eval(postman.getGlobalVariable("module:crypto"));

// ...your script contents...
```

After calling the `eval` above, you will have access to the `CryptoJS` namespace via `this.CryptoJS`.
```js
var encrypted = this.CryptoJS.AES.encrypt(...);
```

### Login Test Cases
There are several test cases in the collection. Each "Login" test case is a different API login and has specific **user** and
**organization** information contained therein.

#### Body
Each Login test case requires you enter the user credentials in the "Body" tab in JSON format:

Example of "Body" contents:
```json
{
  "user": "christophe.mckinnon@fedex.com",
  "password": "senseAware1"
}
```

#### Pre-request Script
Each Login test case also requires you to set up the organization information in the "Pre-request Script" tab:

Example of "Pre-request Script:
```js
// Load up CryptoJS library. Do this at the top of any pre-request script you need CryptoJS in.
// You must have previously downloaded and set the "module:crypto" variable.
eval(postman.getGlobalVariable("module:crypto"));

// Create our uri to hit and encode.
var uri = "/sasec/ECustomerServices/rest/v1/session?_=" + (new Date().getTime());

// Grab and encode the private key
var privateKey = this.CryptoJS.enc.Utf8.parse("abcd1234abcd1234");

// Set the uri in our address above
postman.setEnvironmentVariable("uri", uri);

// Encrypt the uri using the private key
var encrypted = this.CryptoJS.AES.encrypt(uri, privateKey, {
    iv: this.CryptoJS.enc.Hex.parse("0000000000000000"), // always
    keySize: 16,
    mode: this.CryptoJS.mode.CBC,
    padding: this.CryptoJS.pad.Pkcs7
});

// Set the SA_SIGNATURE values
postman.setEnvironmentVariable("clientId", "MNX");
postman.setEnvironmentVariable("clientKey", encrypted.ciphertext.toString(this.CryptoJS.enc.Base64));

```
**NOTE:** `uri` is the path to the External API endpoint you want to test and will be different based upon the test case.

**NOTE:** The `privateKey` and `clientId` will be specific to an organization.

### Other Test Cases

All other (non Login) test cases will still require the encryption code in the "Pre-request Script" tab, but will not require
the user credential "Body" payload. Depending upon the API endpoint, it may not require a "Body" payload at all.
